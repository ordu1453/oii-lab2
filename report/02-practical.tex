\chapter{Практическая часть}

\section{Используемые инструменты}

Для реализации нечеткой системы использована библиотека \texttt{scikit-fuzzy} и язык
 Python 3.  
Основные зависимости:
\begin{itemize}
    \item \texttt{numpy} — численные вычисления;
    \item \texttt{matplotlib} — визуализация;
    \item \texttt{scikit-fuzzy} — функции принадлежности и дефаззификация.
\end{itemize}

\section{Функции принадлежности}

На рисунках \ref{img:de}-\ref{img:vf} представлены функции 
принадлежности нечетких переменных.

\includeimage
    {de}
    {f}
    {h}
    {0.55\textwidth}
    {Функция принадлежности расстояния между автомобилями}

\includeimage
    {dd}
    {f}
    {h}
    {0.55\textwidth}
    {Функция принадлежности изменения расстояния}

\includeimage
    {vf}
    {f}
    {h}
    {0.55\textwidth}
    {Функция принадлежности скорости автопилота}

\section{Реализация алгоритма Ларсена}

В библиотеке scikit-fuzzy в качестве алгоритма логического вывода применяется
алгоритм Мамдани, без возможности выбора альтернативы. 
Одним из вариантов реализации алгоритма Ларсена с использованием бибилиотеки
scikit-fuzzy, является замена строк кода в исходном коде.

\includelistingpretty
{rule.py} % Имя файла с расширением (файл должен быть расположен в директории inc/lst/)
{python} % Язык программирования (необязательный аргумент)
{Исходный код библиотеки scikit-fuzzy} % Подпись листинга

Как видно из листинга \ref{lst:rule.py}, выходом функции логического И является 
минимальное из двух значений \lstinline|and_func = np.fmin| (по Мамдани).
Заменив этот кусок кода на \lstinline|and_func=np.multiply|, получим алгоритм вывода
Ларсена.

\section{Результаты}

На рисунке~\ref{img:result} показана динамика движения автомобилей.  
Автопилот плавно регулирует скорость, удерживая требуемую дистанцию от лидера даже при изменении его скорости.

% \includeimage
%     {result}
%     {f}
%     {h}
%     {0.75\textwidth}
%     {Результаты моделирования движения автомобилей}

Среднеквадратичная ошибка поддержания дистанции составила:
\[
MSE = 0.153.
\]

Время моделирования при шаге интегрирования \( dt = 0.1 \) и \( T = 100 \, c \) составило менее 1 секунды.

\section{Особенности реализации}

\begin{itemize}
    \item Импликация Ларсена реализована вручную как масштабирование функции принадлежности по вертикали.
    \item Используется произведение степеней истинности для расчета силы активации (\( \alpha = \mu_1 \times \mu_2 \)).
    \item Дефаззификация выполняется методом центра тяжести (\texttt{fuzz.defuzz(..., 'centroid')}).
    \item Система легко расширяется на \( X=3 \) при добавлении новых входных переменных (например, бокового смещения).
\end{itemize}
